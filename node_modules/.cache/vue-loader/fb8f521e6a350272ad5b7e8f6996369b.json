{"remainingRequest":"D:\\BL\\vue-bilibili-master\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\BL\\vue-bilibili-master\\src\\views\\Home.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\BL\\vue-bilibili-master\\src\\views\\Home.vue","mtime":1593351739000},{"path":"D:\\BL\\vue-bilibili-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\BL\\vue-bilibili-master\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\BL\\vue-bilibili-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\BL\\vue-bilibili-master\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBOYXZCYXIgZnJvbSAiQC9jb21wb25lbnRzL2NvbW1vbi9OYXZiYXIudnVlIjsKaW1wb3J0IGNvdmVyIGZyb20gIi4vY292ZXIiOwpleHBvcnQgZGVmYXVsdCB7CiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGNhdGVnb3J5OiBbXSwKICAgICAgYWN0aXZlOiAwCiAgICB9OwogIH0sCiAgY29tcG9uZW50czogewogICAgTmF2QmFyLAogICAgY292ZXIKICB9LAogIGFjdGl2YXRlZCgpIHsKICAgIGlmKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCduZXdDYXQnKSkgewogICAgICAgIGxldCBuZXdDYXQgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCduZXdDYXQnKSkKICAgICAgICB0aGlzLmNhdGVnb3J5ID0gdGhpcy5jaGFuZ2VDYXRlZ29yeShuZXdDYXQpCiAgICAgICAgdGhpcy5zZWxlY3RBcnRpY2xlKCk7CiAgICB9CiAgfSwKICBtZXRob2RzOiB7CiAgICBhc3luYyBzZWxlY3RDYXRlZ29yeSgpIHsKICAgICAgaWYobG9jYWxTdG9yYWdlLmdldEl0ZW0oJ25ld0NhdCcpKSB7CiAgICAgICAgcmV0dXJuCiAgICAgIH0KICAgICAgY29uc3QgcmVzID0gYXdhaXQgdGhpcy4kaHR0cC5nZXQoIi9jYXRlZ29yeSIpOwogICAgICB0aGlzLmNhdGVnb3J5ID0gdGhpcy5jaGFuZ2VDYXRlZ29yeShyZXMuZGF0YSk7CiAgICAgIHRoaXMuc2VsZWN0QXJ0aWNsZSgpOwogICAgfSwKICAgIGNoYW5nZUNhdGVnb3J5KGRhdGEpIHsKICAgICAgY29uc3QgY2F0ZWdvcnkxID0gZGF0YS5tYXAoKGl0ZW0sIGluZGV4KSA9PiB7CiAgICAgICAgaXRlbS5saXN0ID0gW107CiAgICAgICAgaXRlbS5wYWdlID0gMDsKICAgICAgICBpdGVtLmZpbmlzaGVkID0gZmFsc2U7CiAgICAgICAgaXRlbS5sb2FkaW5nID0gdHJ1ZTsKICAgICAgICBpdGVtLnBhZ2VzaXplID0gMTA7CiAgICAgICAgcmV0dXJuIGl0ZW07CiAgICAgIH0pOwogICAgICByZXR1cm4gY2F0ZWdvcnkxOwogICAgfSwKICAgIGFzeW5jIHNlbGVjdEFydGljbGUoKSB7CiAgICAgIGNvbnN0IGNhdGVnb3J5aXRlbSA9IHRoaXMuY2F0ZWdvcnlJdGVtKCk7CiAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IHRoaXMuJGh0dHAuZ2V0KCIvZGV0YWlsLyIgKyBjYXRlZ29yeWl0ZW0uX2lkLCB7CiAgICAgICAgcGFyYW1zOiB7CiAgICAgICAgICBwYWdlOiBjYXRlZ29yeWl0ZW0ucGFnZSwKICAgICAgICAgIHBhZ2VzaXplOiBjYXRlZ29yeWl0ZW0ucGFnZXNpemUKICAgICAgICB9CiAgICAgIH0pOwogICAgICBjYXRlZ29yeWl0ZW0ubGlzdC5wdXNoKC4uLnJlcy5kYXRhKTsKICAgICAgY2F0ZWdvcnlpdGVtLmxvYWRpbmcgPSBmYWxzZTsKICAgICAgaWYgKHJlcy5kYXRhLmxlbmd0aCA8IGNhdGVnb3J5aXRlbS5wYWdlc2l6ZSkgewogICAgICAgIGNhdGVnb3J5aXRlbS5maW5pc2hlZCA9IHRydWU7CiAgICAgIH0KICAgIH0sCiAgICBvbkxvYWQoKSB7CiAgICAgIGNvbnN0IGNhdGVnb3J5aXRlbSA9IHRoaXMuY2F0ZWdvcnlJdGVtKCk7CiAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgIGNhdGVnb3J5aXRlbS5wYWdlICs9IDE7CiAgICAgICAgdGhpcy5zZWxlY3RBcnRpY2xlKCk7CiAgICAgIH0sIDEwMDApOwogICAgfSwKICAgIGNhdGVnb3J5SXRlbSgpIHsKICAgICAgY29uc3QgY2F0ZWdvcnlpdGVtID0gdGhpcy5jYXRlZ29yeVt0aGlzLmFjdGl2ZV07CiAgICAgIHJldHVybiBjYXRlZ29yeWl0ZW07CiAgICB9CiAgfSwKICB3YXRjaDogewogICAgYWN0aXZlKCkgewogICAgICBjb25zdCBjYXRlZ29yeWl0ZW0gPSB0aGlzLmNhdGVnb3J5SXRlbSgpOwogICAgICBpZiAoIWNhdGVnb3J5aXRlbS5saXN0Lmxlbmd0aCkgewogICAgICAgIHRoaXMuc2VsZWN0QXJ0aWNsZSgpOwogICAgICB9CiAgICB9CiAgfSwKICBjcmVhdGVkKCkgewogICAgdGhpcy5zZWxlY3RDYXRlZ29yeSgpOwogIH0KfTsK"},{"version":3,"sources":["Home.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Home.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <div class=\"home\" v-if=\"category\">\n    <nav-bar></nav-bar>\n    <div class=\"categorytab\">\n      <div class=\"category-ico\" @click=\"$router.push('/editcategory')\"><van-icon name=\"setting-o\" /></div>\n      <van-tabs v-model=\"active\" swipeable sticky animated>\n        <van-tab v-for=\"(item,index) in category\" :key=\"index\" :title=\"item.title\">\n          <van-list\n            v-model=\"item.loading\"\n            :immediate-check=\"false\"\n            :finished=\"item.finished\"\n            finished-text=\"我也是有底线的\"\n            @load=\"onLoad\"\n          >\n            <div class=\"detailparent\">\n              <cover\n                class=\"detailitem\"\n                :detailitem=\"categoryitem\"\n                v-for=\"(categoryitem,categoryindex) in item.list\"\n                :key=\"categoryindex\"\n              />\n            </div>\n          </van-list>\n        </van-tab>\n      </van-tabs>\n    </div>\n  </div>\n</template>\n\n<script>\nimport NavBar from \"@/components/common/Navbar.vue\";\nimport cover from \"./cover\";\nexport default {\n  data() {\n    return {\n      category: [],\n      active: 0\n    };\n  },\n  components: {\n    NavBar,\n    cover\n  },\n  activated() {\n    if(localStorage.getItem('newCat')) {\n        let newCat = JSON.parse(localStorage.getItem('newCat'))\n        this.category = this.changeCategory(newCat)\n        this.selectArticle();\n    }\n  },\n  methods: {\n    async selectCategory() {\n      if(localStorage.getItem('newCat')) {\n        return\n      }\n      const res = await this.$http.get(\"/category\");\n      this.category = this.changeCategory(res.data);\n      this.selectArticle();\n    },\n    changeCategory(data) {\n      const category1 = data.map((item, index) => {\n        item.list = [];\n        item.page = 0;\n        item.finished = false;\n        item.loading = true;\n        item.pagesize = 10;\n        return item;\n      });\n      return category1;\n    },\n    async selectArticle() {\n      const categoryitem = this.categoryItem();\n      const res = await this.$http.get(\"/detail/\" + categoryitem._id, {\n        params: {\n          page: categoryitem.page,\n          pagesize: categoryitem.pagesize\n        }\n      });\n      categoryitem.list.push(...res.data);\n      categoryitem.loading = false;\n      if (res.data.length < categoryitem.pagesize) {\n        categoryitem.finished = true;\n      }\n    },\n    onLoad() {\n      const categoryitem = this.categoryItem();\n      setTimeout(() => {\n        categoryitem.page += 1;\n        this.selectArticle();\n      }, 1000);\n    },\n    categoryItem() {\n      const categoryitem = this.category[this.active];\n      return categoryitem;\n    }\n  },\n  watch: {\n    active() {\n      const categoryitem = this.categoryItem();\n      if (!categoryitem.list.length) {\n        this.selectArticle();\n      }\n    }\n  },\n  created() {\n    this.selectCategory();\n  }\n};\n</script>\n\n<style lang=\"less\">\n.home {\n  background-color: white;\n}\n.detailparent {\n  display: flex;\n  flex-wrap: wrap;\n  justify-content: space-around;\n  .detailitem {\n    margin: 1.389vw 0;\n    width: 45%;\n  }\n}\n.categorytab{\n  position: relative;\n  .category-ico{\n    position: absolute;\n    z-index: 5;\n    right: 0;\n    top: 1.944vw;\n    padding: 1.389vw 2.778vw;\n    background-color: white;\n  }\n}\n\n</style>"]}]}